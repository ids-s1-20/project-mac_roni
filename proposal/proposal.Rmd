---
title: "Project proposal"
author: "macRoni"
output: github_document
---

```{r load-packages, message = FALSE}
library(tidyverse)
library(broom)
library(readr)
library(skimr)
```

## 1. Introduction
The dataset is a Skytrax User Reviews Dataset (published August 2nd, 2015) at https://github.com/quankiquanki/skytrax-reviews-dataset .  


General Theme: Which amenities impact the airline rating the most?

## 2. Data

```{r read-files, message = FALSE }
airline <- read_csv("/cloud/project/data/airline.csv")
airport <- read_csv("/cloud/project/data/airport.csv")
lounge <- read_csv("/cloud/project/data/lounge.csv")
seat <- read_csv("/cloud/project/data/seat.csv")
```

```{r}
glimpse(airline)
glimpse(airport)
glimpse(lounge)
glimpse(seat)
```

## 3. Data analysis plan

We first began by exploring the overall average ratings of the different airlines. 

```{r}
airline %>%
  group_by(airline_name) %>%
  summarise( average_overall_rating = mean(overall_rating, na.rm = TRUE)) %>%
  arrange(desc(average_overall_rating))

```

Next, we visualised the distribution of the traveller types the airline attracts.
Although, this visualization doesn't take into account the 31018 missing values. 

```{r}
airline %>%
  filter(type_traveller != "NA") %>%
  ggplot( mapping = aes( y = type_traveller)) +
  geom_bar() +
  labs( title = "Distribution of the traveller types", 
        y = "Traveller types" 
        ) +
  theme_minimal()
```


1. How does the overall ratings for airlines change depending of the time of year? Do these patterns repeat every year? Which traveller type is prev during which time of the year?

First, all NAs for the response variable and the predictor were removed. 

```{r mean-ratings-airlines, message = FALSE, echo = FALSE}
airline_nonas <- airline %>%
  drop_na(overall_rating) #removing any NAs
```

Next, a plot of mean ratings vs time shows how airline ratings change over time for ryanair and lufthansa. Values before 2014 were disregarded as there were too few of them to show any significant correlation. 

```{r plot-of-ryanair-vs-lufthansa, message = FALSE, echo = FALSE}
airline_nonas %>%
  group_by(airline_name, date) %>%
  summarise(mean_overall_rating = mean(overall_rating, na.rm = TRUE)) %>%
  filter(airline_name %in% c("ryanair", "lufthansa"),
         date >= "2014-01-01") %>%
  ggplot(aes(x = date, y = mean_overall_rating, color = airline_name)) +
  geom_line() +
  geom_smooth() +
  labs(
    title = "Overall ratings of Lufthansa and Ryanair",
    subtitle = "From 2014 to 2015",
    x = "Date",
    y = "Overall Rating"
  ) +
  facet_wrap(~airline_name) +
  guides(fill = guide_legend(title = NULL)) 
  
```

As the visualization shows, the ratings for ryanair have been steady at around 7 over 2013 and 2014, but have started deteriorating in 2015.Comparing this to a more expensive company like lufthansa reveals that the overall ratings are more steady. 

On the other hand, there is no clear pattern in each year, which makes sense as the airline companies will normally try to provide the same service throughout the year. 

2. To what extent do passengers in business class give better overall ratings than passengers in economy/Premium Economy?
Does this alternate between different airplane types?
Y: overall_rating
X: type_traveller , cabin_flown, aircraft   

Hypothesis: we expect business to have a higher rating and will use the correlation between overall rating and cabin flown to validate our hypothesis. 

Do airlines improve their ratings with a particular reviewer over time, if so in which category are the improvements made
Y: overall_rating, other variables TBD after the most significant contributor is found 
X: author, date, airline_name 

Do positive reviews on an airline and positive reviews on lounge and seat have a correlation?
Y: a graph showing correlation 
X: overall_rating (in seat and lounge data set )

Hypothesis: we expect seat rating to have a stronger correlation than the lounge rating because not everyone uses the lounge. 

***Question to the instructor: Is it possible to segment the reviews into “positive” and “negative” ones (using text analysis on the content column) and replace all the positive and negative reviews with the words “good” or “bad”?***
